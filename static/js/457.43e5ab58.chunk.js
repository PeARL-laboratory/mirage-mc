"use strict";(self.webpackChunkmirage_mc=self.webpackChunkmirage_mc||[]).push([[457],{14101:function(t,e,a){a.d(e,{ZP:function(){return y},Wz:function(){return D}});var n=a(72791),i=n.createContext(null),r=a(80184),o=a(29439),s=a(4942),c=a(1413),l=a(84136),u=a(763),d=a.p+"static/media/stations_listed.62a01fcccd6c8d8910be.csv",f=a.p+"static/media/locations_listed.f85c1cdb7238c3b3b584.csv",m=a.p+"static/media/metadata.508f1effc7264ccc4778.csv",v=a.p+"static/media/streamDetail.2db5fb2c64b18016cd7d.csv";function g(t,e){var a=e.type,n=e.path,i=e.isLoading,r=void 0!==i&&i,o=e.error,l=void 0!==o&&o,u=e.hasError,d=void 0!==u&&u,f=e.value;switch(a){case"LOADING_CHANGED":return(0,c.Z)((0,c.Z)({},t),{},(0,s.Z)({},n,(0,c.Z)((0,c.Z)({},t[n]),{},{isLoading:r})));case"VALUE_CHANGE":return(0,c.Z)((0,c.Z)({},t),{},(0,s.Z)({},n,(0,c.Z)((0,c.Z)({},t[n]),{},{value:f,isLoading:r,error:l,hasError:d})));case"INIT":return(0,c.Z)((0,c.Z)({},t),{},{isInit:f});default:throw new Error}}var p={rawData:{value:{stationData:[],locationData:[],metaData:[],streamDetail:[]}},locs:{},countries:{},events:{},loading:!1,error:!1,isInit:!1},y=function(t){var e=t.children,a=(0,n.useReducer)(g,p),s=(0,o.Z)(a,2),y=s[0],D=s[1];(0,n.useEffect)((function(){if(!y.rawData.isLoading&&!y.rawData.value.metaData.length){1;try{console.time("Load and process data"),console.time("-Load data-"),D({type:"LOADING_CHANGED",path:"rawData",isLoading:!0}),D({type:"LOADING_CHANGED",path:"locs",isLoading:!0}),D({type:"LOADING_CHANGED",path:"countries",isLoading:!0}),Promise.all([(0,l.gyn)(d),(0,l.gyn)(f),(0,l.gyn)(m),(0,l.gyn)(v)]).then((function(t){var e=(0,o.Z)(t,4),a=e[0],n=e[1],i=e[2],r=e[3];console.timeEnd("-Load data-"),console.time("-Correct data-");var s={};n.forEach((function(t){t.lat=+t.longitude,t.long=+t.latitude,delete t.longitude,delete t.latitude,s[t.city_id]=t}));var u={};a.forEach((function(t){t.lat=s[t.city_id].lat,t.long=s[t.city_id].long,t.country=s[t.city_id].country,t.city=s[t.city_id].city,u[t.station_id]=t})),i.forEach((function(t){t.station_genre=u[t.station_id].station_genre,t.city=s[t.city_id].city,t.country=s[t.city_id].country,t.station=u[t.station_id].station,t.stream_artist=r[t.stream_detail_id].stream_artist,t.stream_song=r[t.stream_detail_id].stream_song}));var d={stationData:a,locationData:n,metaData:i,streamDetail:r,stationDataMap:u,locationDataMap:s};D({type:"VALUE_CHANGE",path:"rawData",value:d,isLoading:!1}),console.timeEnd("-Correct data-"),console.time("-filterdata-");var f=function(t){var e=t.stationData,a=t.locationData,n=t.metaData,i=(0,l.Xxj)(e,(function(t){return t.city_id}));console.time("---group meta---");var r=(0,l.ruo)(a,(function(t){return t.city_id})),o=(0,l.ruo)(n,(function(t){return t.city_id}));console.timeEnd("---group meta---");var s=i.map((function(t){var e,a,n,i=null!==(e=o.get(t[0]))&&void 0!==e?e:[],s=null!==(a=(null!==(n=r.get(t[0]))&&void 0!==n?n:[])[0])&&void 0!==a?a:{};return(0,c.Z)((0,c.Z)({},s),{},{title:"".concat(s.city," - ").concat(s.country),count:t[1].length,values:t[1],city:[[s.city,i]].map((function(t){return t.title=t[0],t.count=t[1].length,t}))})}));return s.sort((function(t,e){return e.count-t.count})),{locs:s,countries:(0,l.Xxj)(e,(function(t){return t.country})).map((function(t){return{title:t[0],long:(0,l.J69)(t[1],(function(t){return t.long})),lat:(0,l.J69)(t[1],(function(t){return t.lat})),count:t[1].length,values:t[1]}})).sort((function(t,e){return e.count-t.count}))}}(d),m=f.locs,v=f.countries;D({type:"VALUE_CHANGE",path:"locs",value:m,isLoading:!1}),D({type:"VALUE_CHANGE",path:"countries",value:v,isLoading:!1}),console.timeEnd("-filterdata-"),console.timeEnd("Load and process data")}))}catch(t){D({type:"ERROR",path:"rawData",isLoading:!1,error:t,hasError:!0}),D({type:"ERROR",path:"locs",isLoading:!1,error:t,hasError:!0}),D({type:"ERROR",path:"countries",isLoading:!1,error:t,hasError:!0})}}}),[]);var h=(0,n.useCallback)((function(t){return!!y[t]&&y[t].error}),[y]),_=(0,n.useCallback)((function(t){return y[t]&&y[t].value?y[t].value:[]}),[y]),x=(0,n.useCallback)((function(t){switch(t){case"city":return y.rawData&&y.rawData.value.locationData?y.rawData.value.locationData.map((function(t){return t.city})):[];case"country":return y.countries&&y.countries.value?y.countries.value.map((function(t){return t.title})):[];case"station":return y.rawData&&y.rawData.value.stationData?(0,u.uniq)(y.rawData.value.stationData.map((function(t){return t.station}))):[];case"station_genre":return y.rawData&&y.rawData.value.metaData?(0,u.uniq)(y.rawData.value.metaData.map((function(t){return t.station_genre}))):[];case"stream_artist":return y.rawData&&y.rawData.value.streamDetail?(0,u.uniq)(y.rawData.value.streamDetail.map((function(t){return t.stream_artist}))):[];case"stream_song":return y.rawData&&y.rawData.value.streamDetail?(0,u.uniq)(y.rawData.value.streamDetail.map((function(t){return t.stream_song}))):[];default:return[]}}),[y]),L=(0,n.useCallback)((function(){return y.events&&y.events.value?y.events.value:[]}),[y]),Z=(0,n.useCallback)((function(t,e){D({type:"LOADING_CHANGED",path:"events",isLoading:!0}),new Promise((function(a,n){var i,r=(null!==(i=y.rawData.value)&&void 0!==i?i:{metaData:[]}).metaData.slice();Object.keys(t).forEach((function(e){t[e]&&r.length&&((0,u.isArray)(t[e])?t[e].length&&(r=r.filter((function(a){return t[e].find((function(t){return t===a[e]}))}))):t[e]&&(r=r.filter((function(a){return a[e]===t[e]}))))}));var o=r.slice(0,e);D({type:"VALUE_CHANGE",path:"events",value:o,isLoading:!1}),console.log(o.length),a(o)}))}),[y]),w=(0,n.useCallback)((function(t){var e=(y.events&&y.events.value?y.events.value:[]).find((function(e){return e.stream_detail_id===t}));return e?(0,c.Z)((0,c.Z)({},e),{},{station_description:y.rawData.value.stationDataMap[e.station_id].station_description,station_url:y.rawData.value.stationDataMap[e.station_id].station_url,lat:y.rawData.value.locationDataMap[e.city_id].lat,long:y.rawData.value.locationDataMap[e.city_id].long,url:y.rawData.value.stationDataMap[e.station_id].url,stream_song:y.rawData.value.streamDetail[e.stream_detail_id].stream_song}):null}),[y]),C=(0,n.useCallback)((function(t){return!!y[t]&&y[t].isLoading}),[y]);return(0,r.jsx)(i.Provider,{value:{getList:_,getEvents:L,requestEvents:Z,getDistinctField:x,getDetail:w,getListError:h,isLoading:C},children:e})};function D(){return(0,n.useContext)(i)}},78305:function(t,e,a){a.d(e,{X:function(){return n},e:function(){return i}});var n=[{accessorKey:"city",header:"City"},{accessorKey:"country",header:"Country"},{accessorKey:"station",header:"Station"},{accessorKey:"station_genre",header:"Station Genre"},{accessorKey:"stream_artist",header:"Artist"},{accessorKey:"stream_song",header:"Song"},{accessorKey:"time_station",header:"Time",filterDisable:!0}],i=n.filter((function(t){return!t.filterDisable}))},92326:function(t,e,a){a.r(e),a.d(e,{default:function(){return F}});var n=a(1413),i=a(72791),r=a(7538),o=a.n(r),s=a(79397),c=a.n(s),l=a(11015),u=a(61862),d=a(42404),f=a(57689),m=a(93539),v=a(80349),g=a(11068),p=a(95321),y=a(76019),D=a(22779),h=a(92392),_=a(6058),x=a(69550),L=a(91490),Z=a(95074),w=a(16737),C=a(1116),E=a(8712),b=a(56309),T=a(91891),A=a(80184),I=function(t){var e=t.intl,a=t.updateLocale,n=t.locale,i=t.menuContext,r=t.themeContext,o=t.a2HSContext,s=t.auth,c=i.toggleThis,l=i.isDesktop,u=(i.isAuthMenuOpen,i.isMiniSwitchVisibility),d=r.themeID,f=r.setThemeID,m=r.isRTL,v=r.toggleThisTheme,g=s.auth,p=(s.setAuth,o.isAppInstallable),I=o.isAppInstalled,M=o.deferredPrompt,j=b.Z.map((function(t){return{value:void 0,visible:!0,primaryText:e.formatMessage({id:t.locale}),onClick:function(){a(t.locale)},leftIcon:(0,A.jsx)(y.Z,{})}})),k=g.isAuthenticated,N=T.Z.map((function(t){return{value:void 0,visible:!0,primaryText:e.formatMessage({id:t.id}),onClick:function(){f(t.id)},leftIcon:(0,A.jsx)(D.Z,{style:{color:t.color}})}}));return[{value:"/",visible:k,primaryText:e.formatMessage({id:"home"}),leftIcon:(0,A.jsx)(h.Z,{})},{value:"/about",visible:!0,primaryText:e.formatMessage({id:"about"}),leftIcon:(0,A.jsx)(_.Z,{})},{divider:!0},{primaryText:e.formatMessage({id:"settings"}),primaryTogglesNestedList:!0,leftIcon:(0,A.jsx)(x.Z,{}),nestedItems:[{primaryText:e.formatMessage({id:"theme"}),secondaryText:e.formatMessage({id:d}),primaryTogglesNestedList:!0,leftIcon:(0,A.jsx)(D.Z,{}),nestedItems:N},{primaryText:e.formatMessage({id:"language"}),secondaryText:e.formatMessage({id:n}),primaryTogglesNestedList:!0,leftIcon:(0,A.jsx)(y.Z,{}),nestedItems:j},{visible:!!l,onClick:function(){c("isMiniSwitchVisibility")},primaryText:e.formatMessage({id:"menu_mini_mode"}),leftIcon:u?(0,A.jsx)(L.Z,{}):(0,A.jsx)(Z.Z,{})},{onClick:function(){v("isRTL")},primaryText:"".concat(m?"LTR":"RTL"," mode"),leftIcon:m?(0,A.jsx)(w.Z,{}):(0,A.jsx)(C.Z,{})}]},{value:null,visible:p&&!I,onClick:function(){M.prompt()},primaryText:e.formatMessage({id:"install",defaultMessage:"Install"}),leftIcon:(0,A.jsx)(E.Z,{})}]},M=a(29439),j=a(78687),k=a(49079),N=(a(69824),a(15927)),R=a(67414),G=a(46314),O=a(93006),H=a(78305),K=a(14101),V=a(45987),S=a(77262),q=["children","role"],P=i.forwardRef((function(t,e){var a=t.children,r=t.role,o=(0,V.Z)(t,q),s=Array.isArray(a)?a.length:0,c=(0,i.useRef)(null);return(0,A.jsx)("div",{ref:e,role:r,children:(0,A.jsx)("div",(0,n.Z)((0,n.Z)({},o),{},{ref:c,children:(0,A.jsx)(S.ViewportList,{viewportRef:c,items:a,count:s,children:function(t){var e=t.props,a=t.type;return(0,i.createElement)(a,(0,n.Z)((0,n.Z)({},e),{},{key:e.id}))}})}))})})),U=(0,N.D)(),z=function(t,e){return U(t,e).slice(0,50)};function X(){var t=(0,j.v9)(k.mj),e=(0,j.I0)(),a=(0,i.useState)({}),r=(0,M.Z)(a,2),o=r[0],s=r[1],c=(0,K.Wz)(),l=c.isLoading,u=c.getDistinctField;return(0,i.useEffect)((function(){if(!l("rawData")&&!l("countries")){console.log("here");var t={};H.e.forEach((function(e){t[e.accessorKey]=u(e.accessorKey)})),s(t)}}),[l("rawData"),l("countries")]),(0,A.jsx)(R.Z,{spacing:2,padding:2,children:H.e.map((function(a){var i,r;return(0,A.jsx)(G.Z,{multiple:!0,size:"small",limitTags:2,filterOptions:z,ListboxComponent:P,options:null!==(i=o[a.accessorKey])&&void 0!==i?i:[],value:null!==(r=t[a.accessorKey])&&void 0!==r?r:[],defaultValue:null,onChange:function(t,n){e((0,k.Tv)({key:a.accessorKey,value:n}))},renderInput:function(t){return(0,A.jsx)(O.Z,(0,n.Z)((0,n.Z)({},t),{},{label:a.header}))}})}))})}var F=function(t){var e=(0,m.Z)(),a=(0,f.s0)(),i=(0,f.TH)(),r=(0,u.aC)(),s=(0,g.useMenu)(),y=(0,l.OA)(),D=s||{},h=D.toggleThis,_=D.isMiniMode,x=D.isMiniSwitchVisibility,L=(0,d.useConfig)().appConfig,Z=(0,v.useLocale)(),w=Z.setLocale,C=Z.locale,E=void 0===C?"en":C,b=(0,p.useTheme)(),T=I((0,n.Z)({intl:e,locale:E,updateLocale:w,menuContext:s,themeContext:b,appConfig:L,a2HSContext:y,auth:r},t)).filter((function(t){return!1!==t.visible})),M=i?i.pathname:"/";return(0,A.jsx)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:(0,A.jsxs)(o(),{style:{flex:1},children:[(0,A.jsx)(X,{}),(0,A.jsx)(c(),{onIndexChange:function(t,e){void 0!==e&&h("isMobileMenuOpen",!1),void 0!==e&&e!==Object(e)&&a(e)},useMinified:_,items:T,index:M},x+b.isRTL)]})})}}}]);
//# sourceMappingURL=457.43e5ab58.chunk.js.map