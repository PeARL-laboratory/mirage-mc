"use strict";(self.webpackChunkmirage_mc=self.webpackChunkmirage_mc||[]).push([[773],{4101:function(t,e,n){n.d(e,{ZP:function(){return m},Wz:function(){return b}});var a=n(2791),i=a.createContext(null),r=n(184),o=n(9439),s=n(4942),l=n(1413),c=n(4166),u=n(763),d=n.p+"static/media/stations_listed.62a01fcccd6c8d8910be.csv",h=n.p+"static/media/locations_listed.f85c1cdb7238c3b3b584.csv",f=n.p+"static/media/metadata.508f1effc7264ccc4778.csv",g=n.p+"static/media/streamDetail.2db5fb2c64b18016cd7d.csv";function p(t,e){var n=e.type,a=e.path,i=e.isLoading,r=void 0!==i&&i,o=e.error,c=void 0!==o&&o,u=e.hasError,d=void 0!==u&&u,h=e.value;switch(n){case"LOADING_CHANGED":return(0,l.Z)((0,l.Z)({},t),{},(0,s.Z)({},a,(0,l.Z)((0,l.Z)({},t[a]),{},{isLoading:r})));case"VALUE_CHANGE":return(0,l.Z)((0,l.Z)({},t),{},(0,s.Z)({},a,(0,l.Z)((0,l.Z)({},t[a]),{},{value:h,isLoading:r,error:c,hasError:d})));case"INIT":return(0,l.Z)((0,l.Z)({},t),{},{isInit:h});default:throw new Error}}var x={rawData:{value:{stationData:[],locationData:[],metaData:[],streamDetail:[]}},locs:{},countries:{},events:{},loading:!1,error:!1,isInit:!1},v=0,m=function(t){var e=t.children,n=(0,a.useReducer)(p,x),s=(0,o.Z)(n,2),m=s[0],b=s[1];(0,a.useEffect)((function(){if(!v){v=1;try{console.time("Load and process data"),console.time("-Load data-"),b({type:"LOADING_CHANGED",path:"rawData",isLoading:!0}),b({type:"LOADING_CHANGED",path:"locs",isLoading:!0}),b({type:"LOADING_CHANGED",path:"countries",isLoading:!0}),Promise.all([(0,c.gyn)(d),(0,c.gyn)(h),(0,c.gyn)(f),(0,c.gyn)(g)]).then((function(t){var e=(0,o.Z)(t,4),n=e[0],a=e[1],i=e[2],r=e[3];console.timeEnd("-Load data-"),console.time("-Correct data-");var s={};a.forEach((function(t){t.lat=+t.longitude,t.long=+t.latitude,delete t.longitude,delete t.latitude,s[t.city_id]=t}));var u={};n.forEach((function(t){t.lat=s[t.city_id].lat,t.long=s[t.city_id].long,t.country=s[t.city_id].country,t.city=s[t.city_id].city,u[t.station_id]=t})),i.forEach((function(t){t.station_genre=u[t.station_id].station_genre,t.city=s[t.city_id].city,t.country=s[t.city_id].country,t.station=u[t.station_id].station,t.stream_artist=r[t.stream_detail_id].stream_artist,t.stream_title=r[t.stream_detail_id].stream_title}));var d={stationData:n,locationData:a,metaData:i,streamDetail:r,stationDataMap:u,locationDataMap:s};b({type:"VALUE_CHANGE",path:"rawData",value:d,isLoading:!1}),console.timeEnd("-Correct data-"),console.time("-filterdata-");var h=function(t){var e=t.stationData,n=t.locationData,a=t.metaData,i=(0,c.Xxj)(e,(function(t){return t.city_id}));console.time("---group meta---");var r=(0,c.ruo)(n,(function(t){return t.city_id})),o=(0,c.ruo)(a,(function(t){return t.city_id}));console.timeEnd("---group meta---");var s=i.map((function(t){var e,n,a,i=null!==(e=o.get(t[0]))&&void 0!==e?e:[],s=null!==(n=(null!==(a=r.get(t[0]))&&void 0!==a?a:[])[0])&&void 0!==n?n:{};return(0,l.Z)((0,l.Z)({},s),{},{title:"".concat(s.city," - ").concat(s.country),count:t[1].length,values:t[1],city:[[s.city,i]].map((function(t){return t.title=t[0],t.count=t[1].length,t}))})}));return s.sort((function(t,e){return e.count-t.count})),{locs:s,countries:(0,c.Xxj)(e,(function(t){return t.country})).map((function(t){return{title:t[0],long:(0,c.J69)(t[1],(function(t){return t.long})),lat:(0,c.J69)(t[1],(function(t){return t.lat})),count:t[1].length,values:t[1]}})).sort((function(t,e){return e.count-t.count}))}}(d),f=h.locs,g=h.countries;b({type:"VALUE_CHANGE",path:"locs",value:f,isLoading:!1}),b({type:"VALUE_CHANGE",path:"countries",value:g,isLoading:!1}),b({type:"VALUE_CHANGE",path:"events",value:i,isLoading:!1}),console.timeEnd("-filterdata-"),console.timeEnd("Load and process data")}))}catch(t){b({type:"ERROR",path:"rawData",isLoading:!1,error:t,hasError:!0}),b({type:"ERROR",path:"locs",isLoading:!1,error:t,hasError:!0}),b({type:"ERROR",path:"countries",isLoading:!1,error:t,hasError:!0})}}}),[]);var j=(0,a.useCallback)((function(t){return!!m[t]&&m[t].error}),[m]),y=(0,a.useCallback)((function(t){return m[t]&&m[t].value?m[t].value:[]}),[m]),Z=(0,a.useCallback)((function(t){switch(t){case"City":return m.rawData&&m.rawData.value.locationData?m.rawData.value.locationData.map((function(t){return t.city})):[];case"Country":return m.countries&&m.countries.value?m.countries.value.map((function(t){return t.title})):[];case"Genre":return m.rawData&&m.rawData.value.metaData?(0,u.uniq)(m.rawData.value.metaData.map((function(t){return t.station_genre}))):[];case"Artist":return m.rawData&&m.rawData.value.streamDetail?(0,u.uniq)(m.rawData.value.streamDetail.map((function(t){return t.stream_artist}))):[];case"Song":return m.rawData&&m.rawData.value.streamDetail?(0,u.uniq)(m.rawData.value.streamDetail.map((function(t){return t.stream_song}))):[];default:return[]}}),[m]),_=(0,a.useCallback)((function(t){return(m.events&&m.events.value?m.events.value:[]).slice(0,t)}),[m]),w=(0,a.useCallback)((function(t){var e=(m.events&&m.events.value?m.events.value:[]).find((function(e){return e.stream_detail_id===t}));return e?(0,l.Z)((0,l.Z)({},e),{},{station_description:m.rawData.value.stationDataMap[e.station_id].station_description,station_url:m.rawData.value.stationDataMap[e.station_id].station_url,lat:m.rawData.value.locationDataMap[e.city_id].lat,long:m.rawData.value.locationDataMap[e.city_id].long,url:m.rawData.value.stationDataMap[e.station_id].url,stream_song:m.rawData.value.streamDetail[e.stream_detail_id].stream_song}):null}),[m]),C=(0,a.useCallback)((function(t){return!!m[t]&&m[t].isLoading}),[m]);return(0,r.jsx)(i.Provider,{value:{getList:y,getEvents:_,getDistinctField:Z,getDetail:w,getListError:j,isLoading:C},children:e})};function b(){return(0,a.useContext)(i)}},169:function(t,e,n){n.r(e),n.d(e,{default:function(){return Q}});var a=n(9439),i=n(2791),r=n(3539),o=n(1413),s=n(5321),l=n(4350),c=n(3967),u=n(2404),d=n(4003),h=n(5256),f=n(9464),g=n(977),p=n(4567),x=n(986),v=n(7607),m=n(9631),b=n(184);function j(t){var e=t.children,n=t.pageTitle,a=t.onBackClick,j=t.isLoading,y=t.appBarContent,Z=void 0===y?null:y,_=t.contentStyle,w=t.tabs,C=void 0===w?null:w,D=(0,s.useTheme)().isRTL,E=(0,d.useOnline)(),L=(0,c.Z)(),k=((0,u.useConfig)().appConfig||{}).menu||{},R=k.width,S=void 0===R?240:R,A=k.appBarLeadingContent,M=void 0===A?null:A,I=(0,i.useContext)(l.default),P=I.toggleThis,G=I.isDesktop,N=I.isMenuOpen,T=(0,r.Z)(),z="";("string"===typeof n||n instanceof String)&&(z=n);return(0,b.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[(0,b.jsx)(h.Z,{position:G?"absolute":void 0,sx:{width:N&&G?"calc(100% - ".concat(S,"px)"):void 0,zIndex:L.zIndex.drawer,transition:L.transitions.create(["width","margin"],{easing:L.transitions.easing.sharp,duration:L.transitions.duration.leavingScreen}),maxHeight:64,marginLeft:D?0:-12,marginRight:D?30:0,backgroundColor:"transparent",backgroundImage:"none",boxShadow:"none"},children:(0,b.jsxs)(f.Z,{children:[N&&G||!a&&(0,b.jsx)(g.Z,{color:"inherit","aria-label":"open drawer",onClick:function(){N?P("isMobileMenuOpen"):(P("isMiniMode",!1),P("isMenuOpen",!0),G||P("isMobileMenuOpen"))},edge:"start",children:(0,b.jsx)(v.Z,{})}),a&&(0,b.jsx)(g.Z,{color:"inherit","aria-label":"open drawer",onClick:a,children:(0,b.jsx)(m.Z,{})}),!a&&N&&!1,M,(0,b.jsx)(p.Z,{variant:"h6",color:"inherit",noWrap:!0,children:z}),(0,b.jsx)("div",{style:{flex:"1 1 auto"}}),Z]})}),(0,b.jsx)("div",{style:{alignItems:"center",justifyContent:"flex-end",minHeight:64}}),j&&(0,b.jsx)(x.Z,{}),!E&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",width:"100%",height:15,backgroundColor:L.palette.secondary.main},children:(0,b.jsx)(p.Z,{variant:"caption",color:"textSecondary",noWrap:!0,children:T.formatMessage({id:"offline",defaultMessage:"Offline"})})}),C,(0,b.jsx)("div",{style:(0,o.Z)({flex:1,overflow:"auto"},_),children:e})]})}var y=n(4101),Z=n(4729),_=n(5849),w=n(8588),C=n(2492),D=n(8060),E=n(4554),L=n(1692),k=n(4166),R=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],S=k.BYU().range([.01,.7]),A=k.BYU().range([.1,.7]);var M=function(t){var e=t.locs,n=t.countries,r=t.width,o=t.height,s=(0,i.useRef)(),l=(0,i.useState)("country"),c=(0,a.Z)(l,2),u=c[0],d=(c[1],(0,i.useState)()),h=(0,a.Z)(d,2),f=h[0],g=(h[1],(0,i.useState)(0)),p=(0,a.Z)(g,2),x=p[0],v=p[1],m=(0,i.useState)([{lat:-92.52824601944323,lng:38.31079101844495,altitude:1.8},{lat:51.58421865,lng:45.9571029,altitude:1.8},{lat:31.3037101,lng:-89.29276214,altitude:1.8},{lat:33.5842591,lng:-101.8804709,altitude:1.8}]),j=(0,a.Z)(m,2),y=j[0],Z=j[1],_=(0,i.useMemo)((function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#454545",e=k.PKp(R),n=function(n){if(!n||""===n||""===n.trim)return"black";var a=e.domain();return a.find((function(t){return t===n}))||a.length<20?e(n):t};return n.domain=e.domain,n.range=e.range,n}()}),[]);function w(t){var e=t.locs,n=t.countries,a=k.Wem(e,(function(t){return t.count}));S.domain(a),A.domain(k.Wem(n,(function(t){return t.count}))),_.domain([]).range(R),n.forEach((function(t){return _(t.title)}));var i=0;return n.length>3&&[0,1,2,3,0].forEach((function(t){y[i]||(y[i]={lat:0,lng:0,altitude:1}),y[i].lat=n[t].lat,y[i].lng=n[t].long,i++})),{MAP_CENTERs:y}}(0,i.useEffect)((function(){var t=w({locs:e,countries:n}).MAP_CENTERs;Z(t),v(0)}),[e,n]);var C=(0,i.useState)(null),D=(0,a.Z)(C,2),E=D[0],M=D[1];(0,i.useEffect)((function(){if(s.current&&x<y.length){var t=setTimeout((function(){s.current.pointOfView(y[x],4e3),v(x+1)}),4e3);return M(t),function(){clearInterval(t)}}}),[x,y]);var I=(0,i.useCallback)((function(){E&&clearInterval(E),v(y.length)}),[E]);return(0,i.useCallback)((function(t,e){s.current&&(I(),s.current.pointOfView({lat:e,lng:t,altitude:.8},2e3))}),[x,I]),(0,b.jsx)("div",{style:{background:"#000010",position:"relative"},children:(0,b.jsx)("div",{style:{transform:"translate(0, -20%)",height:"100vh"},children:(0,b.jsx)(L.Z,{width:r,height:o,ref:s,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-night.jpg",labelsData:n,labelLat:(0,i.useCallback)((function(t){return t.lat}),[]),labelLng:(0,i.useCallback)((function(t){return t.long}),[]),labelAltitude:(0,i.useCallback)((function(t){return f&&f.title===t.title?.15:.1}),[f]),labelText:(0,i.useCallback)((function(t){return t.title}),[]),labelSize:(0,i.useCallback)((function(t){return S(t.count)/3}),[]),labelDotRadius:0,labelColor:(0,i.useCallback)((function(t){var e;return f&&f.title===t.title?"#dd6700":null!==(e=t.color)&&void 0!==e?e:"white"}),[f]),labelResolution:2,hexBinPointsData:e,hexBinPointWeight:"count",hexBinPointLng:(0,i.useCallback)((function(t){return t.long}),[]),hexBinPointLat:(0,i.useCallback)((function(t){return t.lat}),[]),hexAltitude:(0,i.useCallback)((function(t){return S(t.sumWeight)}),[]),hexBinResolution:4,hexTopColor:(0,i.useCallback)((function(t){return _(t.points[0][u])}),[]),hexSideColor:(0,i.useCallback)((function(t){return _(t.points[0][u])}),[]),hexBinMerge:!0,hexLabel:(0,i.useCallback)((function(t){return"\n            <b>".concat(t.points.length,"</b> stations:<ul><li>\n              ").concat(t.points.slice().sort((function(t,e){return e.count-t.count})).map((function(t){return t.title})).join("</li><li>"),"\n            </li></ul>\n          ")}),[]),onGlobeClick:I})})})},I=n(6525),P=n(2269),G=(n(8920),function(t){var e=t.data,n=t.onSelectRow,r=(0,i.useMemo)((function(){return[{accessorKey:"city",header:"City"},{accessorKey:"country",header:"Country"},{accessorKey:"station",header:"Station"},{accessorKey:"station_genre",header:"Station Genre"},{accessorKey:"stream_artist",header:"Artist"},{accessorKey:"stream_title",header:"Song"},{accessorKey:"time_station",header:"Time"}]}),[]),o=(0,i.useRef)(null),s=(0,i.useState)(!1),l=(0,a.Z)(s,2),c=l[0],u=(l[1],(0,i.useState)([])),d=(0,a.Z)(u,2),h=d[0],f=d[1];return(0,i.useEffect)((function(){console.log("I have been call!!!")}),[e]),(0,i.useEffect)((function(){var t;null===(t=o.current)||void 0===t||t.scrollToIndex(0)}),[h]),(0,b.jsx)(P.ZP,{columns:r,data:e,enableBottomToolbar:!1,enableGlobalFilterModes:!0,enableDensityToggle:!1,enablePagination:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"300px"}},initialState:{density:"compact"},onSortingChange:f,state:{isLoading:c,sorting:h},rowVirtualizerInstanceRef:o,rowVirtualizerProps:{overscan:8},muiTableBodyRowProps:function(t){var e=t.row;return{onClick:function(){n(e.original)},sx:{cursor:"pointer"}}},enableColumnResizing:!0,defaultColumn:{minSize:20,maxSize:9001,size:100}})}),N=n(5469),T=n(4721),z=n(220),B=n(2426),O=n.n(B),H=n(4642);var U=function(t){var e=t.data;return(0,b.jsx)(w.Z,{children:(0,b.jsxs)(C.Z,{children:[(0,b.jsx)(p.Z,{component:"div",variant:"h2",children:e.station}),(0,b.jsx)(p.Z,{component:"div",variant:"subtitle1",color:"text.secondary",children:e.station_description}),(0,b.jsxs)("table",{style:{width:"100%"},children:[(0,b.jsxs)("colgroup",{children:[(0,b.jsx)("col",{style:{width:130}}),(0,b.jsx)("col",{})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Station Genre"}),(0,b.jsx)("td",{children:e.station_genre})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Station URL"}),(0,b.jsx)("td",{children:(0,b.jsx)(N.Z,{href:e.station_url,target:"_blank",color:"secondary",children:e.station_url})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Location"}),(0,b.jsx)("td",{children:(0,b.jsxs)(N.Z,{target:"_blank",color:"secondary",href:"https://maps.google.com/?q=".concat(e.lat,",").concat(e.long),children:[(0,b.jsx)(H.Z,{}),e.city,", ",e.country]})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Radio Garden URL"}),(0,b.jsx)("td",{children:(0,b.jsx)(N.Z,{href:e.url,target:"_blank",color:"secondary",children:e.station_url})})]}),(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colspan:"2",children:(0,b.jsx)(T.Z,{sx:{mt:2,mb:2}})})}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Artist"}),(0,b.jsxs)("td",{style:{display:"flex"},children:[(0,b.jsx)(z.Z,{"aria-label":"recipe",sx:{mr:1},children:e.stream_artist[0]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Z,{variant:"h5",color:"text.primary",children:e.stream_artist}),(0,b.jsx)(p.Z,{variant:"subtitle2",children:"NA"})]})]})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Song"}),(0,b.jsx)("td",{children:e.stream_song})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Time Monitored"}),(0,b.jsx)("td",{children:O()(e.time_station).format("LLL")})]})]})]})})},V=n(4942),K=n(6934),W=n(2065),q=n(139),F=n(5403),Y=(0,K.ZP)("div")((function(t){var e=t.theme;return(0,V.Z)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:(0,W.Fq)(e.palette.common.white,.15),"&:hover":{backgroundColor:(0,W.Fq)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"})})),J=(0,K.ZP)("div")((function(t){return{padding:t.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),X=(0,K.ZP)(q.ZP)((function(t){var e=t.theme;return{color:"inherit","& .MuiInputBase-input":(0,V.Z)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),")"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}}));var $=function(){return(0,b.jsxs)(Y,{children:[(0,b.jsx)(J,{children:(0,b.jsx)(F.Z,{})}),(0,b.jsx)(X,{placeholder:"Search\u2026",inputProps:{"aria-label":"search"}})]})},Q=function(){(0,r.Z)();var t=(0,y.Wz)(),e=t.getList,n=t.isLoading,o=t.getEvents,s=t.getDetail,l=(0,i.useState)(),c=(0,a.Z)(l,2),u=c[0],d=c[1];(0,i.useEffect)((function(){}),[]);var h=n("rawData"),f=(n("events"),n("locs")),g=(0,i.useCallback)((function(t){var e=t.stream_detail_id,n=s(e);d(n)}),[o]);return(0,b.jsxs)(j,{appBarContent:(0,b.jsx)($,{}),children:[(0,b.jsx)("div",{style:{position:"absolute",top:0,left:0,zIndex:0,height:"100%",width:"100%",overflow:"hidden"},children:(0,b.jsx)(I.Z,{style:{height:"100%",width:"100%"},children:function(t){var n=t.height,a=t.width;return(0,b.jsx)(M,{locs:e("locs"),countries:e("countries"),width:a,height:n})}})}),(0,b.jsxs)(Z.Z,{container:!0,sx:{height:"100%",position:"relative",pointerEvents:"none"},direction:"column",justifyContent:"space-between",children:[(0,b.jsx)(Z.Z,{sx:{pointerEvents:"none"},children:(0,b.jsx)(_.Z,{color:"secondary",children:"Zone 1"})}),(0,b.jsxs)(Z.Z,{container:!0,spacing:2,m:0,sx:{pointerEvents:"auto"},children:[(0,b.jsx)(Z.Z,{item:!0,xs:8,children:(0,b.jsx)(w.Z,{sx:{minHeight:275,backgroundColor:function(t){return tt(t.palette.background.paper)}},children:(0,b.jsxs)(C.Z,{children:[(0,b.jsx)(p.Z,{children:"Event list"}),(0,b.jsx)(G,{data:o(1e3),onSelectRow:g})]})})}),u&&(0,b.jsx)(Z.Z,{item:!0,xs:4,children:(0,b.jsx)(w.Z,{sx:{minHeight:275,backgroundColor:function(t){return tt(t.palette.background.paper)}},children:(0,b.jsx)(C.Z,{children:(0,b.jsx)(U,{data:u})})})})]})]}),(0,b.jsx)(D.Z,{sx:{color:"#fff",zIndex:function(t){return t.zIndex.drawer+1}},open:h||f,children:(0,b.jsxs)(E.Z,{sx:{display:"flex",alignItems:"center",width:"50%",flexDirection:"column",textAlign:"center"},children:[(0,b.jsx)(E.Z,{sx:{width:"100%"},children:(0,b.jsx)(x.Z,{variant:"determinate",value:h?40:f?90:100})}),(0,b.jsx)(E.Z,{sx:{width:"100%"},children:(0,b.jsx)("h2",{children:h?"Read data....":f?"Process data...":"Done!"})})]})})]})};function tt(t){var e=(0,k.$_Y)(t);return e.opacity=.5,e.toString()}}}]);
//# sourceMappingURL=773.ef7d84c7.chunk.js.map