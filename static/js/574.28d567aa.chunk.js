"use strict";(self.webpackChunkmirage_mc=self.webpackChunkmirage_mc||[]).push([[574],{14101:function(t,a,e){e.d(a,{ZP:function(){return h},Wz:function(){return D}});var n=e(72791),r=n.createContext(null),i=e(80184),o=e(29439),s=e(4942),c=e(1413),u=e(84136),l=e(763),d=e.p+"static/media/stations_listed.62a01fcccd6c8d8910be.csv",f=e.p+"static/media/locations_listed.f85c1cdb7238c3b3b584.csv",m=e.p+"static/media/metadata.508f1effc7264ccc4778.csv",p=e.p+"static/media/streamDetail.2db5fb2c64b18016cd7d.csv";function v(t,a){var e=a.type,n=a.path,r=a.isLoading,i=void 0!==r&&r,o=a.error,u=void 0!==o&&o,l=a.hasError,d=void 0!==l&&l,f=a.value;switch(e){case"LOADING_CHANGED":return(0,c.Z)((0,c.Z)({},t),{},(0,s.Z)({},n,(0,c.Z)((0,c.Z)({},t[n]),{},{isLoading:i})));case"VALUE_CHANGE":return(0,c.Z)((0,c.Z)({},t),{},(0,s.Z)({},n,(0,c.Z)((0,c.Z)({},t[n]),{},{value:f,isLoading:i,error:u,hasError:d})));case"INIT":return(0,c.Z)((0,c.Z)({},t),{},{isInit:f});default:throw new Error}}var g={rawData:{value:{stationData:[],locationData:[],metaData:[],streamDetail:[]}},locs:{},countries:{},events:{},loading:!1,error:!1,isInit:!1},h=function(t){var a=t.children,e=(0,n.useReducer)(v,g),s=(0,o.Z)(e,2),h=s[0],D=s[1];(0,n.useEffect)((function(){if(!h.rawData.isLoading&&!h.rawData.value.metaData.length){1;try{console.time("Load and process data"),console.time("-Load data-"),D({type:"LOADING_CHANGED",path:"rawData",isLoading:!0}),D({type:"LOADING_CHANGED",path:"locs",isLoading:!0}),D({type:"LOADING_CHANGED",path:"countries",isLoading:!0}),Promise.all([(0,u.gyn)(d),(0,u.gyn)(f),(0,u.gyn)(m),(0,u.gyn)(p)]).then((function(t){var a=(0,o.Z)(t,4),e=a[0],n=a[1],r=a[2],i=a[3];console.timeEnd("-Load data-"),console.time("-Correct data-");var s={};n.forEach((function(t){t.lat=+t.longitude,t.long=+t.latitude,delete t.longitude,delete t.latitude,s[t.city_id]=t}));var l={};e.forEach((function(t){t.lat=s[t.city_id].lat,t.long=s[t.city_id].long,t.country=s[t.city_id].country,t.city=s[t.city_id].city,l[t.station_id]=t})),r.forEach((function(t){t.station_genre=l[t.station_id].station_genre,t.city=s[t.city_id].city,t.country=s[t.city_id].country,t.station=l[t.station_id].station,t.stream_artist=i[t.stream_detail_id].stream_artist,t.stream_song=i[t.stream_detail_id].stream_song}));var d={stationData:e,locationData:n,metaData:r,streamDetail:i,stationDataMap:l,locationDataMap:s};D({type:"VALUE_CHANGE",path:"rawData",value:d,isLoading:!1}),console.timeEnd("-Correct data-"),console.time("-filterdata-");var f=function(t){var a=t.stationData,e=t.locationData,n=t.metaData,r=(0,u.Xxj)(a,(function(t){return t.city_id}));console.time("---group meta---");var i=(0,u.ruo)(e,(function(t){return t.city_id})),o=(0,u.ruo)(n,(function(t){return t.city_id}));console.timeEnd("---group meta---");var s=r.map((function(t){var a,e,n,r=null!==(a=o.get(t[0]))&&void 0!==a?a:[],s=null!==(e=(null!==(n=i.get(t[0]))&&void 0!==n?n:[])[0])&&void 0!==e?e:{};return(0,c.Z)((0,c.Z)({},s),{},{title:"".concat(s.city," - ").concat(s.country),count:t[1].length,values:t[1],city:[[s.city,r]].map((function(t){return t.title=t[0],t.count=t[1].length,t}))})}));return s.sort((function(t,a){return a.count-t.count})),{locs:s,countries:(0,u.Xxj)(a,(function(t){return t.country})).map((function(t){return{title:t[0],long:(0,u.J69)(t[1],(function(t){return t.long})),lat:(0,u.J69)(t[1],(function(t){return t.lat})),count:t[1].length,values:t[1]}})).sort((function(t,a){return a.count-t.count}))}}(d),m=f.locs,p=f.countries;D({type:"VALUE_CHANGE",path:"locs",value:m,isLoading:!1}),D({type:"VALUE_CHANGE",path:"countries",value:p,isLoading:!1}),console.timeEnd("-filterdata-"),console.timeEnd("Load and process data")}))}catch(t){D({type:"ERROR",path:"rawData",isLoading:!1,error:t,hasError:!0}),D({type:"ERROR",path:"locs",isLoading:!1,error:t,hasError:!0}),D({type:"ERROR",path:"countries",isLoading:!1,error:t,hasError:!0})}}}),[]);var _=(0,n.useCallback)((function(t){return!!h[t]&&h[t].error}),[h]),y=(0,n.useCallback)((function(t){return h[t]&&h[t].value?h[t].value:[]}),[h]),w=(0,n.useCallback)((function(t){switch(t){case"city":return h.rawData&&h.rawData.value.locationData?h.rawData.value.locationData.map((function(t){return t.city})):[];case"country":return h.countries&&h.countries.value?h.countries.value.map((function(t){return t.title})):[];case"station":return h.rawData&&h.rawData.value.stationData?(0,l.uniq)(h.rawData.value.stationData.map((function(t){return t.station}))):[];case"station_genre":return h.rawData&&h.rawData.value.metaData?(0,l.uniq)(h.rawData.value.metaData.map((function(t){return t.station_genre}))):[];case"stream_artist":return h.rawData&&h.rawData.value.streamDetail?(0,l.uniq)(h.rawData.value.streamDetail.map((function(t){return t.stream_artist}))):[];case"stream_song":return h.rawData&&h.rawData.value.streamDetail?(0,l.uniq)(h.rawData.value.streamDetail.map((function(t){return t.stream_song}))):[];default:return[]}}),[h]),E=(0,n.useCallback)((function(){return h.events&&h.events.value?h.events.value:[]}),[h]),L=(0,n.useCallback)((function(t,a){D({type:"LOADING_CHANGED",path:"events",isLoading:!0}),new Promise((function(e,n){var r,i=(null!==(r=h.rawData.value)&&void 0!==r?r:{metaData:[]}).metaData.slice();Object.keys(t).forEach((function(a){t[a]&&i.length&&((0,l.isArray)(t[a])?t[a].length&&(i=i.filter((function(e){return t[a].find((function(t){return t===e[a]}))}))):t[a]&&(i=i.filter((function(e){return e[a]===t[a]}))))}));var o=i.slice(0,a);D({type:"VALUE_CHANGE",path:"events",value:o,isLoading:!1}),console.log(o.length),e(o)}))}),[h]),Z=(0,n.useCallback)((function(t){var a=(h.events&&h.events.value?h.events.value:[]).find((function(a){return a.stream_detail_id===t}));return a?(0,c.Z)((0,c.Z)({},a),{},{station_description:h.rawData.value.stationDataMap[a.station_id].station_description,station_url:h.rawData.value.stationDataMap[a.station_id].station_url,lat:h.rawData.value.locationDataMap[a.city_id].lat,long:h.rawData.value.locationDataMap[a.city_id].long,url:h.rawData.value.stationDataMap[a.station_id].url,stream_song:h.rawData.value.streamDetail[a.stream_detail_id].stream_song}):null}),[h]),C=(0,n.useCallback)((function(t){return!!h[t]&&h[t].isLoading}),[h]);return(0,i.jsx)(r.Provider,{value:{getList:y,getEvents:E,requestEvents:L,getDistinctField:w,getDetail:Z,getListError:_,isLoading:C},children:a})};function D(){return(0,n.useContext)(r)}},91251:function(t,a,e){e.r(a),e.d(a,{default:function(){return P}});var n=e(72791),r=e(1413),i=e(42404),o=e(4708),s=e(21756),c=e.n(s),u=e(95321),l=e(33808),d=e.n(l),f=e(62613),m=e.n(f),p=e(36395),v=function(t,a,e,n){if(a)for(var i=0;i<a.length;i++)if(a[i].id===t){var o=a[i].source,s=null!=o&&o instanceof Function?o(e?"dark":"light"):o,c=null!=s?s.palette:{};return(0,p.Z)((0,r.Z)((0,r.Z)({},s),{},{palette:(0,r.Z)((0,r.Z)({},c),{},{mode:e?"dark":"light"}),direction:n?"rtl":"ltr"}))}return(0,p.Z)({palette:{mode:e?"dark":"light"},direction:n?"rtl":"ltr"})},g=e(98246),h=e(57012),D=e(93539),_=e(27308),y=e.n(_),w=e(78784),E=e.n(w),L=e(98892),Z=e.n(L),C=e(83785),A=e.n(C),b=(e(94933),e(7076),e(29350),e(45224),e(80184)),x=function(t){var a=t.children,e=(0,D.Z)(),n=(0,i.useConfig)().appConfig,s=(0,u.useTheme)(),l=s.themeID,f=s.isDarkMode,p=s.isRTL,_=n||{},w=_.theme,L=_.pwa,Z=_.notistack,C=L||{},A=C.useiOSPWAPrompt,x=C.iOSPWAPromptProps,j=(w||{}).themes,k=v(l,void 0===j?[]:j,f,p);return(0,b.jsxs)(h.Z,{theme:k,children:[(0,b.jsx)(o.ZP,{}),(0,b.jsx)(g.SnackbarProvider,(0,r.Z)((0,r.Z)({maxSnack:3},Z),{},{children:(0,b.jsx)(d(),{children:(0,b.jsx)(m(),{children:(0,b.jsx)(y(),{children:(0,b.jsx)(E(),{children:a})})})})})),A&&(0,b.jsx)(c(),(0,r.Z)({promptOnVisit:1,timesToShow:3,copyTitle:e.formatMessage({id:"ios_prompt_title",defaultMessage:"Add to Home Screen"}),copyClosePrompt:e.formatMessage({id:"ios_prompt_close",defaultMessage:"Close"}),copyBody:e.formatMessage({id:"ios_prompt_body",defaultMessage:"This website has app functionality. Add it to your home screen to use it in fullscreen and while offline."}),copyShareButtonLabel:e.formatMessage({id:"ios_prompt_share_button",defaultMessage:"1) Press the 'Share' button"}),copyAddHomeButtonLabel:e.formatMessage({id:"ios_prompt_add_to_home_button",defaultMessage:"2) Press 'Add to Home Screen'"}),permanentlyHideOnDismiss:!1},x))]})};function j(t){var a=t.children,e=(0,i.useConfig)().appConfig;return(0,b.jsx)(n.Fragment,{children:(0,b.jsx)(Z(),{appConfig:e,children:(0,b.jsx)(A(),{appConfig:e,children:(0,b.jsx)("div",{style:{display:"flex"},children:(0,b.jsx)(x,{children:a})})})})})}var k=e(36571),M=e(69783),N=e(14101);function G(t){var a=t.children;return(0,b.jsx)(N.ZP,{children:(0,b.jsx)(k._,{dateAdapter:M.Z,children:a})})}function P(t){var a=t.children;return(0,b.jsx)(j,{children:(0,b.jsx)(G,{children:a})})}}}]);
//# sourceMappingURL=574.28d567aa.chunk.js.map